<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sistema do Candidato</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <style>
    body { font-family: Arial, sans-serif; }
    .hidden { display: none; }
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-thumb { background-color: #a0aec0; border-radius: 3px; }
  </style>
</head>
<body class="bg-gray-100 text-sm">

  <!-- TELA DE LOGIN/CADASTRO -->
  <div id="loginCadastro" class="flex h-screen">
    <div class="w-1/2 p-10">
      <div id="form-cadastro" class="hidden">
        <h2 class="text-xl font-bold mb-4">Cadastro de Candidato</h2>
        <input id="nome" placeholder="Nome Completo" class="w-full p-2 mb-2 border" />
        <input id="email" placeholder="E-mail" class="w-full p-2 mb-2 border" />
        <input id="senha" placeholder="Senha" type="password" class="w-full p-2 mb-4 border" />
        <button onclick="cadastrar()" class="bg-blue-500 text-white px-4 py-2">Cadastrar</button>
        <p class="mt-2">Já tem conta? <span class="text-blue-600 cursor-pointer" onclick="mostrarLogin()">Entrar</span></p>
      </div>

      <div id="form-login">
        <h2 class="text-xl font-bold mb-4">Login do Candidato</h2>
        <input id="loginEmail" placeholder="E-mail" class="w-full p-2 mb-2 border" />
        <input id="loginSenha" placeholder="Senha" type="password" class="w-full p-2 mb-4 border" />
        <button onclick="fazerLogin()" class="bg-green-500 text-white px-4 py-2">Entrar</button>
        <p class="mt-2">Não tem conta? <span class="text-blue-600 cursor-pointer" onclick="mostrarCadastro()">Cadastrar</span></p>
      </div>
    </div>
    <div class="w-1/2 bg-gray-200 p-10 overflow-auto">
      <h2 class="text-lg font-bold mb-4">Novidades</h2>
      <div id="novidades" class="text-gray-700">Carregando novidades...</div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden">
    <div class="max-w-[1024px] mx-auto border border-gray-300 bg-white">
      <!-- Header -->
      <header class="flex items-center bg-[#d9e8fb] border-b border-gray-300 px-2 py-1 relative select-none">
        <div class="flex items-center gap-2">
          <img src="https://storage.googleapis.com/a1aa/image/ef63bc8a-156e-4c00-224e-44146b3a788e.jpg" width="60" height="60" alt="Logo" />
          <div class="text-[10px] text-[#a0a0a0]">COMISSÃO<br>PERMANENTE<br>DE SELEÇÃO</div>
        </div>
        <h1 class="ml-4 font-extrabold text-[#1f6e1f]">Ambiente de Desenvolvimento</h1>
        <div class="absolute right-2 top-1 flex items-center gap-1 text-black text-xs">
          <span id="usuarioLogado" class="font-bold"></span>
          <span class="cursor-pointer hover:underline" onclick="logout()">Sair</span>
        </div>
      </header>
      <div class="flex">
        <!-- Menu lateral -->
        <nav class="w-[140px] border-r border-gray-300 bg-white text-xs">
          <div class="border-b border-gray-300 px-2 py-1 font-bold">Portal do Candidato</div>
          <ul class="px-2 py-1 space-y-1">
            <li><a href="#" class="block hover:underline">Início</a></li>
            <li><a href="#" class="block text-red-600">Fazer Inscrição</a></li>
            <li><a href="#" class="block hover:underline">Consultar Inscrição</a></li>
            <li><a href="#" class="block hover:underline">Consultar Locais de Prova</a></li>
            <li><a href="#" class="block hover:underline">Consultar Desempenhos</a></li>
            <li><a href="#" class="block hover:underline" onclick="logout()">Sair</a></li>
          </ul>
        </nav>
        <!-- Conteúdo -->
        <main class="flex-1 p-3">
          <form>
            <fieldset class="border p-3 rounded">
              <legend class="font-semibold text-sm">Selecionar a inscrição</legend>
              <div class="mb-3 bg-blue-100 border border-blue-300 text-blue-700 p-3 rounded">
                Selecione abaixo qual o <strong>concurso</strong> e <strong>inscrição</strong> que deseja acessar.
              </div>
              <div class="mb-3 bg-yellow-100 border border-yellow-300 text-yellow-800 p-3 rounded">
                A partir de 2016, todas as inscrições estarão disponíveis neste portal.
              </div>
              <div class="grid grid-cols-[140px_1fr] gap-2 items-center mb-2">
                <label class="text-right">Processos Seletivos</label>
                <select class="border px-2 py-1 rounded w-full">
                  <option>-- Selecione --</option>
                  <option>2024 - Vestibular Engenharia</option>
                </select>
              </div>
              <div class="grid grid-cols-[140px_1fr] gap-2 items-center">
                <label class="text-right">Processos Finalizados</label>
                <select class="border px-2 py-1 rounded w-full">
                  <option>-- Selecione --</option>
                </select>
              </div>
            </fieldset>
          </form>
        </main>
      </div>
    </div>
  </div>

  <script>
    const API_KEY = '6855efa8bb5ccc0c9cf6d9ad';
    const URL_CANDIDATOS = 'https://vestibulares-302d.restdb.io/rest/candidatos';
    const URL_NOVIDADES = 'https://vestibulares-302d.restdb.io/rest/novidades';

    function mostrarCadastro() {
      document.getElementById('form-login').style.display = 'none';
      document.getElementById('form-cadastro').style.display = 'block';
    }

    function mostrarLogin() {
      document.getElementById('form-cadastro').style.display = 'none';
      document.getElementById('form-login').style.display = 'block';
    }

    function cadastrar() {
      const nome = document.getElementById('nome').value;
      const email = document.getElementById('email').value;
      const senha = document.getElementById('senha').value;

      fetch(URL_CANDIDATOS, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-apikey': API_KEY
        },
        body: JSON.stringify({ nome, email, senha })
      })
      .then(res => res.json())
      .then(() => {
        alert('Cadastrado com sucesso!');
        mostrarLogin();
      });
    }

    function fazerLogin() {
      const email = document.getElementById('loginEmail').value;
      const senha = document.getElementById('loginSenha').value;

      fetch(`${URL_CANDIDATOS}?q={"email":"${email}","senha":"${senha}"}`, {
        headers: {
          'x-apikey': API_KEY
        }
      })
      .then(res => res.json())
      .then(data => {
        if (data.length > 0) {
          document.getElementById('loginCadastro').style.display = 'none';
          document.getElementById('dashboard').style.display = 'block';
          document.getElementById('usuarioLogado').textContent = data[0].nome;
        } else {
          alert('Email ou senha incorretos!');
        }
      });
    }

    function logout() {
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('loginCadastro').style.display = 'flex';
      document.getElementById('loginEmail').value = '';
      document.getElementById('loginSenha').value = '';
    }

    function carregarNovidades() {
      fetch(URL_NOVIDADES, {
        headers: {
          'x-apikey': API_KEY
        }
      })
      .then(res => res.json())
      .then(data => {
        if (data.length > 0) {
          document.getElementById('novidades').innerText = data[0].mensagem;
        } else {
          document.getElementById('novidades').innerText = 'Nenhuma novidade publicada.';
        }
      });
    }

    carregarNovidades();
  </script>
</body>
</html>
